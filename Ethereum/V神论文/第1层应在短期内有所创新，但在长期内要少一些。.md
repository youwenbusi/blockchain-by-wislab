# 第1层应在短期内有所创新，但在长期内要少一些。#
在区块链设计中的关键权衡之一是，是将更多的功能构建到基础层区块链本身（“第一层”），还是将其构建到位于区块链顶部的协议中，并且可以在不改变区块链本身（“第二层”）的情况下被创建和修改。迄今为止，权衡方案多次出现在缩放辩论中，一方面块大小增加（和sharding分片），另一方面第二层解决方案（如Plasma和通道），并且在某种程度上区块链的治理，损失和盗窃恢复可以由DAO分叉或通用解决方案解决，其如EIP 867，或通过第二层解决，如可逆Ether（RESH）。那么哪种方法最终更好呢？那些了解我的人，或者把我看作一个肮脏的中间派的人，知道我不可避免地会说“两者兼而有之”。然而，从长远来看，我确实认为，随着产业链越来越成熟，第一层必然会稳定，第二层将承担越来越多的不断创新和改变的负担。

原因有几个。第一，第一层解决方案要求在基础协议层进行持续的协议更改，基础层协议的更改需要治理，**但是需要被证明的是，从长远来看，高度“活跃”的块链治理可以继续而不会引起持续的政治性不确定甚至崩溃成为中心化。**
要从另一个领域举一个例子，请考虑Moxie Marlinspike对Signal的中心化和非联合性质的辩护。对一个公司维护其为了关键业务而控制它所依赖的生态系统的权利的文件，当然应该持保留态度，但是人们仍然可以从这些争论中受益。引用：

（注：Signal是一款消息加密传输的软件，包括群组，文字，语音，视频，文档和图片信息）

> 早期我们处理Signal，其中一个非常有争议的是将它作为非联合服务来构建。我们所开发的任何协议都不需要集中；完全有可能把Signal构建成一个联合基于协议的信使，但我不再相信有可能构建具有竞争力的联合信使。

和：
> 他们的反驳是：“这是愚蠢的，如果没有第三方定义的互操作协议，互联网会走多远？”“我考虑过了。我们获得了第一个生产版本的IP，在过去的20年中，我们一直试图切换到第二个生产版本的IP但进展缓慢。我们在1997中获得了HTTP版本1.1，直到现在仍然被保存在那里。同样，SMTP、IRC、DNS、XMPP在20世纪90年代末期也同样被固定，这就是互联网能走多远。它走到了90年代末。
> 
> 这已经花费了我们相当多的时间，但是不可否认的是，一旦联合了协议，就很难进行更改。现在，在应用程序级别，在生态系统正在前进的世界中，静止的东西不会很好。只要联合意味着停滞，而中心化意味着前进，联合协议就会像今天一样在需要前进的软件环境中存在问题。

此时此刻，以及今后的中期，似乎很清楚的是，去中心化应用平台、加密货币支付、身份系统、声誉系统、去中心化交换机制、拍卖、隐私解决方案、支持隐私解决方案的编程语言，和大多数其他有趣的事情可以在区块链上完成，这些领域将继续有重大的和持续的创新。去中心化应用平台通常需要持续减少确认时间，支付需要快速确认，低交易成本，保护隐私和许多其他内置特性，交易以多种形式和大小出现，包括链上自动市场制造商，频繁批量拍卖、组合拍卖等等。因此，把这些中任何一个“构建”构建到区块链底层都不是一个好主意，因为它将带来很高的治理开销，因为平台将不得不不断地讨论、实现和协调新发现的技术改进。出于同样的原因，联合信使很难在不重新集中化的情况下起步，区块链还需要在采取激进的治理和落后于新出现的替代方案之间做出选择。

（注：这里V神并不是提倡中心化，而是认为如果在一个去中心化产品中，把很多基础协议和其他具体某种应用的特性联合放在底层，在它需要改进这些协议的时候，往往需要中心化地做出改进）

即使是Ethereum集成的特定于有限应用程序的功能预编译器，也受了这种影响。不到一年前，Ethereum采用了拜占庭硬分叉，包括使用alt-bn128曲线来实现环形签名、ZK-SNARKs等应用所需的椭圆曲线操作。现在，Zcash和其他区块链正在向BLS-12-381发展，而Ethereum需要再次付出代价才能赶上。为了避免将来出现类似的问题，Ethereum社区正在寻求将EVM升级到E-WASM，这是一种足够高效的虚拟机，不需要集成特定于应用程序的预编译器。

但也有另一个支持二层解决方案的观点，该方案不依赖于预期的技术开发速度:有时存在不可避免的权衡，没有单一的全局最优解决方案。这在Ethereum 1.0风格的区块链中不太容易看到，在这些区块链中，某些模型是相当普遍的(例如，Ethereum基于账户的模型就是一个例子。然而，在分片区块链中，有一种问题在如今的Ethereum中并不存在:如何进行跨分片交易?也就是说，假设区块链状态具有区域A和区域B，其中很少或没有节点同时处理A和B，系统如何处理同时影响A和B的事务?

（注：上面做出的假设是一个第一层就分片的区块链，目前的以太坊是不分片的，所以说没有遇到这种问题）

当前的解决方案涉及**异步跨分片通信**，这对于转移资产和其他一些应用程序来说已经足够了，但是对于其他许多应用程序来说还不够。同步操作(如为了解决火车和酒店的问题)可以用跨分片拉动固定在顶部，但这需要多轮跨分片的交互，导致明显的延迟。我们可以通过同步执行方案来解决这些问题，但是这需要权衡几个方面:


- 系统不能为每个块中的相同帐户处理多个事务
- 交易必须预先声明它们影响的分片和地址
- 如果交易只在它影响的分片中接受，而在其他分片中不接受，那么任何发出的交易失败(仍然需要支付费用!)的风险很高

似乎很可能可以开发出更好的方案，但它会更复杂，而且很可能有此方案所没有的局限性。从已知的结果可知没有完美的实现;至少，Amdahl定律对某些应用程序和某些类型的交互通过并行处理每秒处理更多交易的能力提出了严格限制。

那么，我们如何创建一个可以测试和部署更好方案的环境呢?答案是一个可以归功于Justin Drake的想法:第二层执行引擎。用户将能够发送资产到“桥合同”,其中使用一些可选组规则处理区块链，从而计算(使用一些间接技术如交互验证或ZK-SNARKs)状态根(认为这相当于第二层的“meta-protocols ”，比如Mastercoin /OMNI和对手最重要的比特币,除了因为桥的合同，这些协议能够处理那些“基账本”定义在底层协议的资产),当且仅当可选规则集生成取款请求时，该规则将处理取款。

![](https://i.imgur.com/Xvs6Hhx.png)

请注意，任何人都可以在任何时候创建一个第二层执行引擎，不同的用户可以使用不同的执行引擎，并且可以相当快地从一个执行引擎切换到任何其他的执行引擎或基本协议。基础区块链不再需要担心成为最优的智能合约处理引擎;它只需要一个带有准图灵完备的执行规则的数据可用性层以便任何第二层的智能合约都可以建立在此之上，并且允许一些基本操作可以在分片之间携带状态数据(事实上，只要ETH转账可以跨分片进行替换就足够了，但是也不需要花费太多的精力来允许跨分片调用，所以我们也可以支持它们)，但除此之外无需更复杂。还要注意，第二层执行引擎可以有不同于第1层的状态管理规则，比如无仓储租金;任何事情都有可能发生，因为特定执行引擎的用户有责任确保它是可持续的，如果他们没有这样做，后果将包含在特定执行引擎的用户中。

从长远来看，第一层不会在所有这些改进上积极竞争;它将为第二层之上的创新提供一个稳定的平台。**这是否意味着，比如说，分片是个坏主意，我们应该保持小的区块链的尺寸和状态，这样即使是10年的旧电脑也能处理每个人的交易?绝对不是。**即使执行引擎部分或完全移动到第2层，关于数据排序和可用性的共识仍然是一个高度可一般化和必要的功能;要了解在没有第一层可伸缩数据的可用性共识的情况下，第二层执行引擎有多困难，请看 Plasma研究中的困难，以及自然扩展到完全通用区块链的困难。比如，如果人们想要将每秒100兆的数据放入一个系统，在这个系统中他们需要对可用性达成共识，那么我们需要每秒100兆的数据可用性达成共识。

此外，第一层在减少延迟方面仍然可以改进;如果第1层比较慢，那么实现非常低延迟的唯一策略就是状态通道，它通常具有较高的资本要求，并且难以推广。状态通道总是会在延迟中打败第1层区块链，因为状态通道只需要一条网络消息，但是在状态通道不能很好工作的情况下，第1层区块链仍然可以更接近它他们现在做的。

因此，另一种极端的情况是，区块链基层可以真正做到绝对最小，并且不需要使用准图灵完备的执行引擎或超出单个节点容量的可伸缩性，这显然也是错误的;基础层的复杂性需要达到一定的最低水平，以便应用程序能够在其上构建，而我们还没有达到这个水平。额外的复杂性是必要的，尽管应该非常小心地选择它，以确保它是最大的通用目的，而不是针对特定的应用程序或技术，这些应用程序或技术将在两年内因为失去兴趣或有更好的选择而过时。

即使在未来，基础层也需要继续进行一些升级，特别是如果有新的技术(如STARKs达到了更高的成熟度级别)允许它们实现比以前更强大的属性，尽管今天的开发人员可以小心翼翼地使基础层平台最大限度地向前兼容这些潜在的改进。因此，为了继续提高可伸缩性、隐私性和通用性，需要在第1层和第2层之间保持平衡，这将继续是事实，尽管随着时间的推移，第2层将继续占据越来越大的创新份额。

**更新2018.08.29:**贾斯汀德雷克指出我另一个好理由为什么有些功能可能最好在第一层实现:这些功能是公共产品,这些功能都是公共产品，因此无法有效或可靠地利用特定功能的使用费提供资金，因此最好的支付方式是通过发行补贴或烧掉交易费支付。一个可能的例子是安全随机数生成。

**翻译和加注：281公里 & 公众号：区块丛林**